-- LocalScript в StarterPlayerScripts
local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")

local player = Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")

-- Современный GUI
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "ModernKeyAuth"
screenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

-- Основной контейнер
local mainContainer = Instance.new("Frame")
mainContainer.Size = UDim2.new(0, 360, 0, 400)
mainContainer.Position = UDim2.new(0.5, -180, 0.5, -200)
mainContainer.BackgroundColor3 = Color3.fromRGB(10, 10, 15)
mainContainer.BackgroundTransparency = 0.05

local containerCorner = Instance.new("UICorner")
containerCorner.CornerRadius = UDim.new(0, 16)
containerCorner.Parent = mainContainer

-- Градиентный бордер
local gradientBorder = Instance.new("Frame")
gradientBorder.Size = UDim2.new(1, 4, 1, 4)
gradientBorder.Position = UDim2.new(0, -2, 0, -2)
gradientBorder.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
gradientBorder.ZIndex = 0

local gradient = Instance.new("UIGradient")
gradient.Color = ColorSequence.new({
    ColorSequenceKeypoint.new(0, Color3.fromRGB(255, 50, 150)),
    ColorSequenceKeypoint.new(0.5, Color3.fromRGB(100, 180, 255)),
    ColorSequenceKeypoint.new(1, Color3.fromRGB(150, 255, 100))
})
gradient.Rotation = 45
gradient.Parent = gradientBorder

local borderCorner = Instance.new("UICorner")
borderCorner.CornerRadius = UDim.new(0, 18)
borderCorner.Parent = gradientBorder

-- Заголовок
local headerFrame = Instance.new("Frame")
headerFrame.Size = UDim2.new(1, 0, 0, 100)
headerFrame.Position = UDim2.new(0, 0, 0, 0)
headerFrame.BackgroundTransparency = 1

local title = Instance.new("TextLabel")
title.Size = UDim2.new(1, 0, 0, 40)
title.Position = UDim2.new(0, 0, 0, 30)
title.BackgroundTransparency = 1
title.Text = "SECURE ACCESS"
title.TextColor3 = Color3.fromRGB(255, 255, 255)
title.TextSize = 26
title.Font = Enum.Font.GothamBold
title.Parent = headerFrame

local subtitle = Instance.new("TextLabel")
subtitle.Size = UDim2.new(1, 0, 0, 20)
subtitle.Position = UDim2.new(0, 0, 0, 70)
subtitle.BackgroundTransparency = 1
subtitle.Text = "Enter authentication key"
subtitle.TextColor3 = Color3.fromRGB(180, 180, 200)
subtitle.TextSize = 14
subtitle.Font = Enum.Font.Gotham
subtitle.Parent = headerFrame

-- Поле ввода ключа (РАБОЧИЙ TextBox)
local inputContainer = Instance.new("Frame")
inputContainer.Size = UDim2.new(0, 300, 0, 80)
inputContainer.Position = UDim2.new(0.5, -150, 0, 120)
inputContainer.BackgroundTransparency = 1

local inputLabel = Instance.new("TextLabel")
inputLabel.Size = UDim2.new(1, 0, 0, 20)
inputLabel.Position = UDim2.new(0, 0, 0, 0)
inputLabel.BackgroundTransparency = 1
inputLabel.Text = "ENTER KEY"
inputLabel.TextColor3 = Color3.fromRGB(150, 150, 200)
inputLabel.TextSize = 12
inputLabel.Font = Enum.Font.Gotham
inputLabel.TextXAlignment = Enum.TextXAlignment.Left
inputLabel.Parent = inputContainer

local inputFrame = Instance.new("Frame")
inputFrame.Size = UDim2.new(1, 0, 0, 50)
inputFrame.Position = UDim2.new(0, 0, 0, 25)
inputFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 40)
inputFrame.BorderSizePixel = 0

local inputCorner = Instance.new("UICorner")
inputCorner.CornerRadius = UDim.new(0, 10)
inputCorner.Parent = inputFrame

-- РАБОЧИЙ TextBox
local inputBox = Instance.new("TextBox")
inputBox.Size = UDim2.new(1, -20, 1, -10)
inputBox.Position = UDim2.new(0, 10, 0, 5)
inputBox.BackgroundTransparency = 1
inputBox.Text = ""
inputBox.PlaceholderText = "Type your key here..."
inputBox.PlaceholderColor3 = Color3.fromRGB(100, 100, 120)
inputBox.TextColor3 = Color3.fromRGB(255, 255, 255)
inputBox.TextSize = 16
inputBox.Font = Enum.Font.Gotham
inputBox.ClearTextOnFocus = false
inputBox.TextXAlignment = Enum.TextXAlignment.Left
inputBox.Parent = inputFrame

-- Подсказка с правильным ключом
local keyHint = Instance.new("TextLabel")
keyHint.Size = UDim2.new(1, 0, 0, 15)
keyHint.Position = UDim2.new(0, 0, 1, 5)
keyHint.BackgroundTransparency = 1
keyHint.Text = "Hint: Key is HOOOW"
keyHint.TextColor3 = Color3.fromRGB(100, 100, 150)
keyHint.TextSize = 11
keyHint.Font = Enum.Font.Gotham
keyHint.TextXAlignment = Enum.TextXAlignment.Left
keyHint.Parent = inputContainer

-- Кнопка проверки
local verifyButton = Instance.new("TextButton")
verifyButton.Size = UDim2.new(0, 280, 0, 45)
verifyButton.Position = UDim2.new(0.5, -140, 0, 230)
verifyButton.BackgroundColor3 = Color3.fromRGB(80, 120, 255)
verifyButton.Text = "VERIFY KEY"
verifyButton.TextColor3 = Color3.fromRGB(255, 255, 255)
verifyButton.TextSize = 16
verifyButton.Font = Enum.Font.GothamSemibold
verifyButton.AutoButtonColor = false

local verifyCorner = Instance.new("UICorner")
verifyCorner.CornerRadius = UDim.new(0, 10)
verifyCorner.Parent = verifyButton

-- Кнопка получения ключа
local getKeyButton = Instance.new("TextButton")
getKeyButton.Size = UDim2.new(0, 280, 0, 35)
getKeyButton.Position = UDim2.new(0.5, -140, 0, 290)
getKeyButton.BackgroundColor3 = Color3.fromRGB(45, 45, 60)
getKeyButton.Text = "GET KEY"
getKeyButton.TextColor3 = Color3.fromRGB(200, 200, 255)
getKeyButton.TextSize = 14
getKeyButton.Font = Enum.Font.Gotham
getKeyButton.AutoButtonColor = false

local getKeyCorner = Instance.new("UICorner")
getKeyCorner.CornerRadius = UDim.new(0, 8)
getKeyCorner.Parent = getKeyButton

-- Кнопка закрытия
local closeButton = Instance.new("TextButton")
closeButton.Size = UDim2.new(0, 30, 0, 30)
closeButton.Position = UDim2.new(1, -35, 0, 15)
closeButton.BackgroundColor3 = Color3.fromRGB(45, 45, 60)
closeButton.Text = "×"
closeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
closeButton.TextSize = 20
closeButton.Font = Enum.Font.GothamBold
closeButton.AutoButtonColor = false

local closeCorner = Instance.new("UICorner")
closeCorner.CornerRadius = UDim.new(1, 0)
closeCorner.Parent = closeButton

-- Статус бар
local statusBar = Instance.new("Frame")
statusBar.Size = UDim2.new(0, 0, 0, 3)
statusBar.Position = UDim2.new(0, 0, 1, -3)
statusBar.BackgroundColor3 = Color3.fromRGB(80, 120, 255)
statusBar.BorderSizePixel = 0
statusBar.Visible = false

local statusCorner = Instance.new("UICorner")
statusCorner.CornerRadius = UDim.new(0, 2)
statusCorner.Parent = statusBar

-- Сообщение о результате
local resultLabel = Instance.new("TextLabel")
resultLabel.Size = UDim2.new(1, -40, 0, 40)
resultLabel.Position = UDim2.new(0, 20, 0, 340)
resultLabel.BackgroundTransparency = 1
resultLabel.Text = ""
resultLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
resultLabel.TextSize = 14
resultLabel.Font = Enum.Font.Gotham
resultLabel.TextWrapped = true
resultLabel.Visible = false
resultLabel.Parent = mainContainer

-- Собираем интерфейс
gradientBorder.Parent = mainContainer
headerFrame.Parent = mainContainer
inputContainer.Parent = mainContainer
verifyButton.Parent = mainContainer
getKeyButton.Parent = mainContainer
closeButton.Parent = mainContainer
statusBar.Parent = mainContainer
resultLabel.Parent = mainContainer
mainContainer.Parent = screenGui
screenGui.Parent = playerGui

-- Состояние системы
local state = {
    scriptLoaded = false,
    animationTime = 0,
    isVerifying = false
}

-- Анимации
local function createHoverEffect(button, normalColor, hoverColor)
    button.MouseEnter:Connect(function()
        TweenService:Create(button, TweenInfo.new(0.2), {BackgroundColor3 = hoverColor}):Play()
    end)
    
    button.MouseLeave:Connect(function()
        TweenService:Create(button, TweenInfo.new(0.2), {BackgroundColor3 = normalColor}):Play()
    end)
end

-- Функция проверки ключа
local function isValidKey(key)
    return key:upper() == "HOOOW"
end

-- Функция загрузки скрипта
local function loadExternalScript()
    if state.scriptLoaded then return true end
    
    local success, result = pcall(function()
        local scriptUrl = "https://raw.githubusercontent.com/WAVA094/d/refs/heads/main/Forsaken"
        local httpScript = game:HttpGet(scriptUrl)
        loadstring(httpScript)()
        return true
    end)
    
    state.scriptLoaded = success
    return success, result
end

-- Анимация статус бара
local function showStatusBar(duration)
    statusBar.Visible = true
    statusBar.Size = UDim2.new(0, 0, 0, 3)
    
    local tween = TweenService:Create(statusBar, TweenInfo.new(duration, Enum.EasingStyle.Linear), {
        Size = UDim2.new(1, 0, 0, 3)
    })
    tween:Play()
    
    return tween
end

-- Показать результат
local function showResult(message, color, duration)
    resultLabel.Text = message
    resultLabel.TextColor3 = color
    resultLabel.Visible = true
    resultLabel.TextTransparency = 0
    
    if duration then
        delay(duration, function()
            TweenService:Create(resultLabel, TweenInfo.new(0.5), {TextTransparency = 1}):Play()
            delay(0.5, function()
                resultLabel.Visible = false
            end)
        end)
    end
end

-- Анимация успешной проверки
local function playSuccessAnimation()
    -- Изменяем цвет градиента на успешный
    local successGradient = Instance.new("UIGradient")
    successGradient.Color = ColorSequence.new({
        ColorSequenceKeypoint.new(0, Color3.fromRGB(100, 255, 150)),
        ColorSequenceKeypoint.new(1, Color3.fromRGB(150, 255, 200))
    })
    successGradient.Rotation = 45
    successGradient.Parent = gradientBorder
    
    -- Анимация кнопки
    verifyButton.Text = "ACCESS GRANTED ✓"
    TweenService:Create(verifyButton, TweenInfo.new(0.3), {
        BackgroundColor3 = Color3.fromRGB(100, 255, 150)
    }):Play()
end

-- Обработчики событий для TextBox
inputBox.Focused:Connect(function()
    TweenService:Create(inputFrame, TweenInfo.new(0.2), {
        BackgroundColor3 = Color3.fromRGB(50, 50, 65)
    }):Play()
end)

inputBox.FocusLost:Connect(function()
    TweenService:Create(inputFrame, TweenInfo.new(0.2), {
        BackgroundColor3 = Color3.fromRGB(30, 30, 40)
    }):Play()
end)

-- Обработчики событий кнопок
verifyButton.MouseButton1Click:Connect(function()
    if state.isVerifying then return end
    
    local key = inputBox.Text
    if key == "" then
        -- Анимация ошибки для поля ввода
        local originalColor = inputFrame.BackgroundColor3
        TweenService:Create(inputFrame, TweenInfo.new(0.1), {
            BackgroundColor3 = Color3.fromRGB(255, 100, 100)
        }):Play()
        wait(0.1)
        TweenService:Create(inputFrame, TweenInfo.new(0.3), {
            BackgroundColor3 = originalColor
        }):Play()
        
        showResult("Please enter a key first!", Color3.fromRGB(255, 100, 100), 2)
        return
    end
    
    state.isVerifying = true
    verifyButton.Text = "VERIFYING..."
    
    -- Показываем статус бар
    local statusTween = showStatusBar(2)
    
    -- Имитация процесса проверки
    spawn(function()
        wait(2) -- Искусственная задержка для реалистичности
        
        if isValidKey(key) then
            playSuccessAnimation()
            showResult("✓ Key verified! Loading script...", Color3.fromRGB(100, 255, 150), 2)
            
            -- Загружаем скрипт
            wait(1)
            local success, errorMsg = loadExternalScript()
            
            if success then
                verifyButton.Text = "SCRIPT LOADED ✓"
                showResult("✓ Script loaded successfully! Closing...", Color3.fromRGB(100, 255, 150), 2)
                
                -- Автозакрытие через 2 секунды
                wait(2)
                TweenService:Create(mainContainer, TweenInfo.new(0.5), {
                    Size = UDim2.new(0, 0, 0, 0),
                    Position = UDim2.new(0.5, 0, 0.5, 0)
                }):Play()
                
                wait(0.5)
                screenGui:Destroy()
            else
                verifyButton.Text = "LOAD FAILED ✗"
                showResult("✗ Failed to load script: " .. tostring(errorMsg), Color3.fromRGB(255, 100, 100), 3)
                state.isVerifying = false
            end
        else
            -- Анимация ошибки
            statusBar.BackgroundColor3 = Color3.fromRGB(255, 100, 100)
            verifyButton.Text = "INVALID KEY ✗"
            showResult("✗ Invalid key! Try: HOOOW", Color3.fromRGB(255, 100, 100), 3)
            
            wait(1.5)
            verifyButton.Text = "VERIFY KEY"
            statusBar.Visible = false
            state.isVerifying = false
        end
    end)
end)

getKeyButton.MouseButton1Click:Connect(function()
    local keyLink = "https://go.linkify.ru/2CQ2"
    
    if setclipboard then
        setclipboard(keyLink)
        getKeyButton.Text = "LINK COPIED!"
        
        -- Визуальное подтверждение
        TweenService:Create(getKeyButton, TweenInfo.new(0.3), {
            BackgroundColor3 = Color3.fromRGB(100, 255, 150)
        }):Play()
        
        showResult("✓ Link copied to clipboard!", Color3.fromRGB(100, 255, 150), 2)
        
        wait(2)
        getKeyButton.Text = "GET KEY"
        TweenService:Create(getKeyButton, TweenInfo.new(0.3), {
            BackgroundColor3 = Color3.fromRGB(45, 45, 60)
        }):Play()
    else
        getKeyButton.Text = "CHECK NOTIFICATIONS!"
        game:GetService("StarterGui"):SetCore("SendNotification", {
            Title = "Get Key",
            Text = "Visit: " .. keyLink,
            Duration = 5
        })
    end
end)

closeButton.MouseButton1Click:Connect(function()
    TweenService:Create(mainContainer, TweenInfo.new(0.4), {
        Size = UDim2.new(0, 0, 0, 0),
        Position = UDim2.new(0.5, 0, 0.5, 0)
    }):Play()
    
    wait(0.4)
    screenGui:Destroy()
end)

-- Эффекты при наведении
createHoverEffect(verifyButton, Color3.fromRGB(80, 120, 255), Color3.fromRGB(100, 140, 275))
createHoverEffect(getKeyButton, Color3.fromRGB(45, 45, 60), Color3.fromRGB(65, 65, 80))
createHoverEffect(closeButton, Color3.fromRGB(45, 45, 60), Color3.fromRGB(65, 65, 80))

-- Анимация появления
mainContainer.Size = UDim2.new(0, 0, 0, 0)
mainContainer.Position = UDim2.new(0.5, 0, 0.5, 0)

wait(0.5)

TweenService:Create(mainContainer, TweenInfo.new(0.8, Enum.EasingStyle.Back, Enum.EasingDirection.Out), {
    Size = UDim2.new(0, 360, 0, 400),
    Position = UDim2.new(0.5, -180, 0.5, -200)
}):Play()

-- Анимация градиента
spawn(function()
    while screenGui and screenGui.Parent do
        state.animationTime = state.animationTime + 0.02
        gradient.Rotation = gradient.Rotation + 0.3
        wait(0.02)
    end
end)

print("Modern Key System loaded! Key: HOOOW")
